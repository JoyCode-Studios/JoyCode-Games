var FollowCamera=pc.createScript("followCamera");FollowCamera.prototype.initialize=function(){this.pos=new pc.Vec3,this.offset=new pc.Vec3},FollowCamera.prototype.postUpdate=function(t){var o=this.app.root.findByName("Ball"),i=this.app.root.findByName("Ball1");if(o&&i){var e=o.getPosition().clone().add(i.getPosition()).scale(.5),s=o.getPosition().distance(i.getPosition());this.offset.set(.75,1,.75).scale(Math.max(4,s+2)),this.pos.copy(e).add(this.offset),this.pos.lerp(this.entity.getPosition(),this.pos,.1),this.entity.setPosition(this.pos),this.entity.lookAt(e)}};var Movement=pc.createScript("movement");Movement.attributes.add("speed",{type:"number",default:.1,min:.05,max:.5,precision:2,description:"Controls the movement speed"}),Movement.prototype.initialize=function(){this.force=new pc.Vec3,this.spawnPos=this.entity.getPosition().clone()},Movement.prototype.update=function(e){if(this.entity.getPosition().y<-1)return void this.teleport(this.spawnPos);const t=this.app.keyboard;let i=0,s=0;if(t.isPressed(pc.KEY_A)&&(i=-this.speed),t.isPressed(pc.KEY_D)&&(i+=this.speed),t.isPressed(pc.KEY_W)&&(s=-this.speed),t.isPressed(pc.KEY_S)&&(s+=this.speed),this.force.set(i,0,s),this.force.lengthSq()>0){this.force.normalize().scale(this.speed);const e=.25*-Math.PI,t=Math.cos(e),i=Math.sin(e),s=this.force.x*t-this.force.z*i,o=this.force.z*t+this.force.x*i;this.force.set(s,0,o)}this.entity.rigidbody.applyImpulse(this.force)},Movement.prototype.teleport=function(e){this.entity.rigidbody.teleport(e),this.spawnPos.copy(e),this.entity.rigidbody.linearVelocity=pc.Vec3.ZERO,this.entity.rigidbody.angularVelocity=pc.Vec3.ZERO};var Teleporter=pc.createScript("teleporter");Teleporter.attributes.add("target",{type:"entity",title:"Target Entity",description:"The target entity where we are going to teleport"}),Teleporter.prototype.initialize=function(){const onTriggerEnter=t=>{if(t.script.movement){const e=this.target.getPosition().clone();e.y+=.5,t.script.movement.teleport(e)}};this.entity.collision.on("triggerenter",onTriggerEnter),this.on("destroy",(()=>{this.entity.collision.off("triggerenter",onTriggerEnter)}))};var Teleporter=pc.createScript("teleporter1");Teleporter.prototype.initialize=function(){const onTriggerEnter=t=>{if(t.script.movement){const e=this.app.root.findByName("Start1");if(e){const o=e.getPosition().clone();o.y+=.5,t.script.movement.teleport(o)}else console.warn("Start1 entity not found")}};this.entity.collision.on("triggerenter",onTriggerEnter),this.on("destroy",(()=>{this.entity.collision.off("triggerenter",onTriggerEnter)}))};var Teleporter=pc.createScript("teleporter2");Teleporter.prototype.initialize=function(){const onTriggerEnter=t=>{if(t.script.movement){const e=this.app.root.findByName("Start2");if(e){const o=e.getPosition().clone();o.y+=.5,t.script.movement.teleport(o)}else console.warn("Start2 entity not found")}};this.entity.collision.on("triggerenter",onTriggerEnter),this.on("destroy",(()=>{this.entity.collision.off("triggerenter",onTriggerEnter)}))};var TouchJoystickInvisible=pc.createScript("touchJoystickInvisible");TouchJoystickInvisible.prototype.initialize=function(){this.app.touch&&(this.touchId=null,this.startPos=new pc.Vec2,this.currentPos=new pc.Vec2,this.direction=new pc.Vec2,this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this))},TouchJoystickInvisible.prototype.onTouchStart=function(t){if(null!==this.touchId)return;const i=t.changedTouches[0];this.touchId=i.identifier,this.startPos.set(i.x,i.y),this.currentPos.copy(this.startPos),this.direction.set(0,0)},TouchJoystickInvisible.prototype.onTouchMove=function(t){for(let i=0;i<t.changedTouches.length;i++){const o=t.changedTouches[i];if(o.identifier===this.touchId){this.currentPos.set(o.x,o.y);const t=this.currentPos.x-this.startPos.x,i=this.currentPos.y-this.startPos.y;this.direction.set(t,i).normalize()}}},TouchJoystickInvisible.prototype.onTouchEnd=function(t){for(let i=0;i<t.changedTouches.length;i++){t.changedTouches[i].identifier===this.touchId&&(this.touchId=null,this.direction.set(0,0))}},TouchJoystickInvisible.prototype.getDirection=function(){return this.direction.clone()};var Telekey=pc.createScript("telekey");Telekey.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this)},Telekey.prototype.onTriggerEnter=function(e){if("Ball"===e.name){var t=this.app.root.findByName("Gate");t&&t.destroy()}};var Teleporter=pc.createScript("teleporter3");Teleporter.prototype.initialize=function(){const onTriggerEnter=t=>{if(t.script.movement){const e=this.app.root.findByName("Start3");if(e){const o=e.getPosition().clone();o.y+=.5,t.script.movement.teleport(o)}else console.warn("Start3 entity not found")}};this.entity.collision.on("triggerenter",onTriggerEnter),this.on("destroy",(()=>{this.entity.collision.off("triggerenter",onTriggerEnter)}))};var Teleporter=pc.createScript("teleporter4");Teleporter.prototype.initialize=function(){const onTriggerEnter=t=>{if(t.script.movement){const e=this.app.root.findByName("Start4");if(e){const o=e.getPosition().clone();o.y+=.5,t.script.movement.teleport(o)}else console.warn("Start4 entity not found")}};this.entity.collision.on("triggerenter",onTriggerEnter),this.on("destroy",(()=>{this.entity.collision.off("triggerenter",onTriggerEnter)}))};var CrumblerTile=pc.createScript("crumblerTile");CrumblerTile.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this)},CrumblerTile.prototype.onTriggerEnter=function(e){"Ball"===e.name&&this.entity.destroy()};var Telekey=pc.createScript("telekey2");Telekey.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this)},Telekey.prototype.onTriggerEnter=function(e){if("Ball"===e.name){var t=this.app.root.findByName("Gate2");t&&t.destroy()}};var Teleporter=pc.createScript("teleporter5");Teleporter.prototype.initialize=function(){const onTriggerEnter=t=>{if(t.script.movement){const e=this.app.root.findByName("Start5");if(e){const o=e.getPosition().clone();o.y+=.5,t.script.movement.teleport(o)}else console.warn("Start5 entity not found")}};this.entity.collision.on("triggerenter",onTriggerEnter),this.on("destroy",(()=>{this.entity.collision.off("triggerenter",onTriggerEnter)}))};var Movement1=pc.createScript("movement1");Movement1.attributes.add("speed",{type:"number",default:.1,min:.05,max:.5,precision:2,description:"Controls the movement speed"}),Movement1.prototype.initialize=function(){this.force=new pc.Vec3,this.spawnPos=this.entity.getPosition().clone()},Movement1.prototype.update=function(e){if(this.entity.getPosition().y<-1)return void this.teleport(this.spawnPos);const t=this.app.keyboard;let i=0,s=0;if(t.isPressed(pc.KEY_LEFT)&&(i=-this.speed),t.isPressed(pc.KEY_RIGHT)&&(i+=this.speed),t.isPressed(pc.KEY_UP)&&(s=-this.speed),t.isPressed(pc.KEY_DOWN)&&(s+=this.speed),this.force.set(i,0,s),this.force.lengthSq()>0){this.force.normalize().scale(this.speed);const e=.25*-Math.PI,t=Math.cos(e),i=Math.sin(e),s=this.force.x*t-this.force.z*i,o=this.force.z*t+this.force.x*i;this.force.set(s,0,o)}this.entity.rigidbody.applyImpulse(this.force)},Movement1.prototype.teleport=function(e){this.entity.rigidbody.teleport(e),this.spawnPos.copy(e),this.entity.rigidbody.linearVelocity=pc.Vec3.ZERO,this.entity.rigidbody.angularVelocity=pc.Vec3.ZERO};var TeleporterMint=pc.createScript("teleporterMint");TeleporterMint.prototype.initialize=function(){const onTriggerEnter=t=>{if("Ball1"===t.name){const e=this.app.root.findByName("StartMint");if(!e)return void console.warn("StartMint entity not found");const n=e.getPosition().clone();n.y+=.5;const o=t.script.movement1;o&&"function"==typeof o.teleport&&o.teleport(n)}};this.entity.collision.on("triggerenter",onTriggerEnter),this.on("destroy",(()=>{this.entity.collision.off("triggerenter",onTriggerEnter)}))};